Vậy là bây giờ chúng ta đã thảo luận về hiện tượng overfitting (quá khớp) và tầm quan trọng của việc tránh hiện tượng này, cũng như tầm quan trọng của việc chia tập dữ liệu thành tập huấn luyện (training data) và tập kiểm tra hoặc xác thực (testing/validation data). Hãy xem cách thực hiện điều này bằng mã lệnh.

Trước tiên, chúng ta cần chia tập dữ liệu thành X và Y vì hiện tại chúng ta chưa thực hiện bước này.

Hy vọng bạn đã theo dõi phần khoa học dữ liệu trong khóa học này và tập dữ liệu của bạn đã được chuẩn bị sẵn sàng. Nếu vậy, hãy bắt đầu từ bất kỳ bước nào bạn đã hoàn thành. Không sao cả nếu bạn chưa làm điều này. Ở đây, chúng ta sẽ tải tập dữ liệu Titanic. Tôi có tập dữ liệu này trong một thư mục tên là Titanic, còn bạn có thể lưu ở nơi khác.

Bắt đầu bằng việc nhập pandas như trước đây và đọc file CSV train.csv vào một biến tên là df (DataFrame). Hãy xem qua dữ liệu bằng cách lấy mẫu 5 hàng.

Trong tập dữ liệu này, chúng ta có ID hành khách (PassengerID), trạng thái sống sót (Survived), và các thông tin khác như hạng vé (Class), tên (Name), giới tính (Sex), tuổi (Age), số lượng anh chị em/vợ chồng (Siblings/Spouses), số lượng cha mẹ/con cái (Parents/Children), vé (Ticket), v.v.

Chia dữ liệu thành X và Y
Chúng ta cần xác định Y là biến phụ thuộc (dependent variable) - yếu tố mà chúng ta muốn dự đoán trong tương lai. Trong trường hợp này, đó là cột Survived. Còn các biến độc lập (independent variables) là tất cả các cột còn lại, chẳng hạn như hạng vé, giới tính, tuổi, v.v.

Để trích xuất Y, chúng ta sử dụng cú pháp df["Survived"]. Với X, chúng ta muốn loại bỏ cột Survived và PassengerID vì hai cột này không cung cấp thông tin hữu ích cho mô hình. Sử dụng df.drop để thực hiện việc này. Đừng quên đặt tham số axis=1 để chỉ định rằng chúng ta đang loại bỏ cột thay vì hàng.

python
Copy code
Y = df["Survived"]
X = df.drop(["Survived", "PassengerID"], axis=1)
Chia dữ liệu thành tập huấn luyện và kiểm tra
Để chia dữ liệu thành tập huấn luyện và kiểm tra, chúng ta sử dụng thư viện Scikit-learn (sklearn). Nếu bạn chưa cài đặt thư viện này, hãy cài đặt bằng lệnh:

bash
Copy code
pip install sklearn
Chúng ta sẽ nhập hàm train_test_split từ module sklearn.model_selection:

python
Copy code
from sklearn.model_selection import train_test_split
Hàm này sẽ chia dữ liệu thành 4 tập: X_train, X_test, Y_train, và Y_test. Đảm bảo giữ đúng thứ tự này khi gán biến. Sử dụng tham số test_size để chỉ định tỷ lệ dữ liệu dành cho tập kiểm tra (giá trị nằm trong khoảng 0 đến 1). Ví dụ, test_size=0.1 sẽ chia 10% dữ liệu vào tập kiểm tra và 90% vào tập huấn luyện.

python
Copy code
X_train, X_test, Y_train, Y_test = train_test_split(X, Y, test_size=0.1)
Tổng kết
Trong bài này, chúng ta đã:

Xác định biến phụ thuộc Y (cột Survived) và biến độc lập X (các cột còn lại, ngoại trừ PassengerID và Survived).
Sử dụng df.drop để loại bỏ các cột không cần thiết.
Sử dụng train_test_split để chia dữ liệu thành tập huấn luyện và kiểm tra.
Hãy tự mình thử nghiệm với mã lệnh này và tiếp tục ở bài học tiếp theo.